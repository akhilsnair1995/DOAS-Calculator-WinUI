<Window
    x:Class="DOASCalculatorWinUI.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:DOASCalculatorWinUI">

    <Grid Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="420"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <MenuBar Grid.Row="0" Grid.ColumnSpan="2">
            <MenuBarItem Title="File">
                <MenuFlyoutItem Text="Open" Click="Open_Click"/>
                <MenuFlyoutItem Text="Save" Click="Save_Click"/>
                <MenuFlyoutItem Text="Export to PDF" Click="ExportPdf_Click"/>
                <MenuFlyoutItem Text="Exit" Click="Exit_Click"/>
            </MenuBarItem>
            <MenuBarItem Title="Units">
                <MenuFlyoutItem Text="Toggle SI/IP" Click="Units_Click"/>
            </MenuBarItem>
        </MenuBar>

        <Border Grid.Row="1" Grid.Column="0" BorderBrush="{ThemeResource SurfaceStrokeColorDefaultBrush}" BorderThickness="0,0,1,0">
            <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="20">
                <StackPanel Spacing="24">
                    <TextBlock Text="System Parameters" Style="{StaticResource SubtitleTextBlockStyle}"/>

                    <StackPanel Spacing="12">
                        <TextBlock Text="Outdoor Conditions" Style="{StaticResource BodyStrongTextBlockStyle}"/>
                        <NumberBox Header="{x:Bind ViewModel.LabelAltitude, Mode=OneWay}" Value="{x:Bind ViewModel.Altitude, Mode=TwoWay}"/>
                        <TextBlock Text="{x:Bind ViewModel.ErrorAltitude, Mode=OneWay}" Foreground="Red" FontSize="12" Visibility="{x:Bind BoolToVis(ViewModel.IsErrorAlt), Mode=OneWay}"/>
                        <NumberBox Header="{x:Bind ViewModel.LabelFlow, Mode=OneWay}" Value="{x:Bind ViewModel.OaFlow, Mode=TwoWay}"/>
                        <NumberBox Header="DB Temp" Value="{x:Bind ViewModel.OaDb, Mode=TwoWay}"/>
                        <NumberBox Header="WB Temp" Value="{x:Bind ViewModel.OaWb, Mode=TwoWay}"/>
                    </StackPanel>

                    <StackPanel Spacing="12">
                        <TextBlock Text="Extract Air" Style="{StaticResource BodyStrongTextBlockStyle}"/>
                        <NumberBox Header="Flow" Value="{x:Bind ViewModel.EaFlow, Mode=TwoWay}"/>
                        <NumberBox Header="DB" Value="{x:Bind ViewModel.EaDb, Mode=TwoWay}"/>
                        <NumberBox Header="RH %" Value="{x:Bind ViewModel.EaRh, Mode=TwoWay}"/>
                    </StackPanel>

                    <StackPanel Spacing="12">
                        <TextBlock Text="Recovery" Style="{StaticResource BodyStrongTextBlockStyle}"/>
                        <ToggleSwitch Header="Enthalpy Wheel" IsOn="{x:Bind ViewModel.WheelEnabled, Mode=TwoWay}"/>
                        <StackPanel Spacing="12" Visibility="{x:Bind BoolToVis(ViewModel.IsWheelFields), Mode=OneWay}">
                            <NumberBox Header="Sensible %" Value="{x:Bind ViewModel.WheelSens, Mode=TwoWay}"/>
                            <NumberBox Header="Latent %" Value="{x:Bind ViewModel.WheelLat, Mode=TwoWay}"/>
                        </StackPanel>
                        <ToggleSwitch Header="Sensible Wheel (SHRW) - Series" IsOn="{x:Bind ViewModel.DwEnabled, Mode=TwoWay}"/>
                        <NumberBox Header="Wheel Eff %" Value="{x:Bind ViewModel.DwEff, Mode=TwoWay}" Visibility="{x:Bind BoolToVis(ViewModel.IsDwFields), Mode=OneWay}"/>
                        <ToggleSwitch Header="Heat Pipe" IsOn="{x:Bind ViewModel.HpEnabled, Mode=TwoWay}"/>
                        <NumberBox Header="Pipe Eff %" Value="{x:Bind ViewModel.HpEff, Mode=TwoWay}" Visibility="{x:Bind BoolToVis(ViewModel.IsHpFields), Mode=OneWay}"/>
                    </StackPanel>

                    <StackPanel Spacing="12">
                        <TextBlock Text="Cooling &amp; Reheat" Style="{StaticResource BodyStrongTextBlockStyle}"/>
                        <ComboBox Header="Coil Type" SelectedIndex="{x:Bind ViewModel.MainCoilTypeIndex, Mode=TwoWay}" HorizontalAlignment="Stretch">
                            <ComboBoxItem Content="DX"/>
                            <ComboBoxItem Content="Water"/>
                        </ComboBox>
                        <NumberBox Header="Off-Coil" Value="{x:Bind ViewModel.OffCoil, Mode=TwoWay}"/>
                        <CheckBox Content="Auto ASHRAE" IsChecked="{x:Bind ViewModel.AutoAshrae, Mode=TwoWay}"/>
                        <ToggleSwitch Header="Reheat Coil" IsOn="{x:Bind ViewModel.ReheatEnabled, Mode=TwoWay}"/>
                        <NumberBox Header="Supply Temp" Value="{x:Bind ViewModel.SupplyTemp, Mode=TwoWay}" Visibility="{x:Bind BoolToVis(ViewModel.IsReheatTarget), Mode=OneWay}"/>
                        
                        <Grid ColumnSpacing="12" Visibility="{x:Bind BoolToVis(ViewModel.IsReheatWater), Mode=OneWay}">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <NumberBox Grid.Column="0" Header="Ent Water" Value="{x:Bind ViewModel.HwEwt, Mode=TwoWay}"/>
                            <NumberBox Grid.Column="1" Header="Lvg Water" Value="{x:Bind ViewModel.HwLwt, Mode=TwoWay}"/>
                        </Grid>
                        <NumberBox Header="Gas Efficiency %" Value="{x:Bind ViewModel.GasEfficiency, Mode=TwoWay}" Visibility="{x:Bind BoolToVis(ViewModel.IsReheatGas), Mode=OneWay}"/>
                    </StackPanel>

                    <StackPanel Spacing="12">
                        <TextBlock Text="Fans &amp; Pressure" Style="{StaticResource BodyStrongTextBlockStyle}"/>
                        <NumberBox Header="Fan System Eff %" Value="{x:Bind ViewModel.FanEff, Mode=TwoWay}"/>
                        <Grid ColumnSpacing="12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <NumberBox Grid.Column="0" Header="Motor Eff %" Value="{x:Bind ViewModel.MotorEff, Mode=TwoWay}"/>
                            <NumberBox Grid.Column="1" Header="Drive Eff %" Value="{x:Bind ViewModel.DriveEff, Mode=TwoWay}"/>
                        </Grid>
                        <Grid ColumnSpacing="12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <NumberBox Grid.Column="0" Header="{x:Bind ViewModel.LabelPress, Mode=OneWay}" Value="{x:Bind ViewModel.SupEsp, Mode=TwoWay}"/>
                            <NumberBox Grid.Column="1" Header="Ext ESP" Value="{x:Bind ViewModel.ExtEsp, Mode=TwoWay}"/>
                        </Grid>
                    </StackPanel>

                    <Button Content="Recalculate" Click="Calculate_Click" Style="{StaticResource AccentButtonStyle}" HorizontalAlignment="Stretch" Margin="0,10,0,24"/>
                </StackPanel>
            </ScrollViewer>
        </Border>

        <Grid Grid.Row="1" Grid.Column="1" Padding="24">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            <StackPanel Spacing="20">
                <TextBlock Text="Design Results" Style="{StaticResource TitleTextBlockStyle}"/>
                <StackPanel>
                    <TextBlock Text="Cooling Load" Foreground="SteelBlue" FontWeight="Bold"/>
                    <TextBlock Text="{x:Bind ViewModel.ResCooling, Mode=OneWay}" FontSize="32" FontWeight="Bold"/>
                    <TextBlock Text="{x:Bind ViewModel.ResCoolingBreakdown, Mode=OneWay}" FontSize="14" Foreground="Gray"/>
                    <TextBlock Text="{x:Bind ViewModel.ResDxUnitPower, Mode=OneWay}" FontWeight="Bold" Foreground="DarkGreen"/>
                </StackPanel>
                <StackPanel>
                    <TextBlock Text="Reheat Load" Foreground="DarkOrange" FontWeight="Bold"/>
                    <TextBlock Text="{x:Bind ViewModel.ResReheat, Mode=OneWay}" FontSize="28" FontWeight="Bold"/>
                </StackPanel>
                <StackPanel>
                    <TextBlock Text="Fan Power" FontWeight="Bold"/>
                    <TextBlock Text="{x:Bind ViewModel.ResFanPower, Mode=OneWay}" FontSize="20" FontWeight="Bold"/>
                    <TextBlock Text="{x:Bind ViewModel.ResFanBreakdown, Mode=OneWay}" FontSize="12" Foreground="Gray"/>
                </StackPanel>
            </StackPanel>

            <StackPanel Grid.Row="1" Margin="0,20,0,0">
                <TextBlock Text="Psychrometric Process Schedule" Style="{StaticResource BodyStrongTextBlockStyle}" Margin="0,0,0,10"/>
                <Grid Padding="10,8" Background="{ThemeResource LayerFillColorDefaultBrush}" BorderBrush="{ThemeResource SurfaceStrokeColorDefaultBrush}" BorderThickness="1" CornerRadius="4,4,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="180"/>
                        <ColumnDefinition Width="180"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Text="Component / Step" FontWeight="Bold" Style="{StaticResource CaptionTextBlockStyle}"/>
                    <TextBlock Text="Entering State" Grid.Column="1" FontWeight="Bold" Style="{StaticResource CaptionTextBlockStyle}"/>
                    <TextBlock Text="Leaving State" Grid.Column="2" FontWeight="Bold" Style="{StaticResource CaptionTextBlockStyle}"/>
                </Grid>
                <ScrollViewer MaxHeight="400" BorderBrush="{ThemeResource SurfaceStrokeColorDefaultBrush}" BorderThickness="1,0,1,1" CornerRadius="0,0,4,4">
                    <ItemsControl ItemsSource="{x:Bind ViewModel.Schedule, Mode=OneWay}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate x:DataType="local:ScheduleItem">
                                <Grid Padding="10,5" BorderBrush="{ThemeResource SurfaceStrokeColorDefaultBrush}" BorderThickness="0,0,0,1">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="180"/>
                                        <ColumnDefinition Width="180"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="{x:Bind Component, Mode=OneWay}" Foreground="{x:Bind Color, Mode=OneWay}" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                    <TextBlock Text="{x:Bind Entering, Mode=OneWay}" Foreground="{x:Bind Color, Mode=OneWay}" Grid.Column="1" FontFamily="Consolas" VerticalAlignment="Center"/>
                                    <TextBlock Text="{x:Bind Leaving, Mode=OneWay}" Foreground="{x:Bind Color, Mode=OneWay}" Grid.Column="2" FontFamily="Consolas" VerticalAlignment="Center"/>
                                </Grid>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </ScrollViewer>
            </StackPanel>
        </Grid>
    </Grid>
</Window>